<!doctype html>
<html lang="ru" data-theme="night">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0b14" />

  <title>Keyboard Tester</title>
  <meta name="description" content="Full keyboard tester: full layout, capture mode, live/latch highlight, day/night theme, offline PWA." />

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />

  <!-- Icons -->
  <link rel="icon" href="favicon.svg" type="image/svg+xml" />
  <link rel="icon" href="favicon.ico" sizes="any" />

  <link rel="stylesheet" href="styles.css" />
  <script src="app.js" defer></script>
</head>

<body>
  <header class="topbar">
    <div class="topbar__left">
      <div class="logo">K</div>
      <div class="brand">
        <div class="brand__title">Keyboard Tester</div>
        <div class="brand__sub">Full layout • Capture • Latch • Day/Night • Offline</div>
      </div>
    </div>

    <div class="topbar__right">
      <button class="chipBtn" id="btnLive" type="button" title="Статус">
        <span class="dot" id="liveDot"></span>
        <span id="liveText">Live</span>
      </button>

      <button class="chipBtn is-on" id="btnCapture" type="button" title="Capture: меньше мешают хоткеи и скролл">
        Capture: ON
      </button>

      <button class="chipBtn" id="btnMode" type="button" title="Live: подсветка только пока держишь. Latch: запоминает подсветку.">
        Mode: Live
      </button>

      <button class="chipBtn" id="btnClear" type="button" title="Сбросить подсветку (и Latch-список)">
        Clear
      </button>

      <span class="sep"></span>

      <button class="chipBtn" id="btnLang" type="button" title="Подписи клавиш RU/EN">
        RU
      </button>

      <button class="chipBtn" id="btnOS" type="button" title="Win / Mac подписи">
        Windows
      </button>

      <button class="chipBtn" id="btnTheme" type="button" title="Day / Night">
        Theme: Night
      </button>

      <button class="chipBtn" id="btnFullscreen" type="button" title="Fullscreen">
        Fullscreen
      </button>

      <button class="chipBtn" id="btnHelp" type="button" title="Help">
        Help
      </button>
    </div>
  </header>

  <main class="app" id="app" tabindex="0" aria-label="Keyboard tester">
    <!-- FULLSCREEN KEYBOARD -->
    <section class="kbViewport" id="kbViewport" aria-label="Keyboard area">
      <div class="kbScale" id="kbScale" aria-hidden="false">
        <div id="keyboard" class="keyboard" aria-label="Keyboard visualization"></div>
      </div>
    </section>

    <!-- HUD / INFO CARD -->
    <aside class="hud card" id="hud" aria-label="Info">
      <div class="hud__top">
        <div class="hud__key" id="hudKey">—</div>
        <div class="hud__hint" id="hudHint">Нажми клавишу</div>
      </div>

      <div class="hud__grid">
        <div class="hud__row">
          <span class="lbl">event.key</span>
          <span class="val" id="metaKey">—</span>
        </div>
        <div class="hud__row">
          <span class="lbl">event.code</span>
          <span class="val mono" id="metaCode">—</span>
        </div>
        <div class="hud__row">
          <span class="lbl">keyCode</span>
          <span class="val mono" id="metaKeyCode">—</span>
        </div>
        <div class="hud__row">
          <span class="lbl">repeat</span>
          <span class="val" id="metaRepeat">—</span>
        </div>
      </div>

      <div class="hud__stats">
        <span class="stat">down: <b id="downCount">0</b></span>
        <span class="stat">max: <b id="maxCount">0</b></span>
        <span class="stat">latched: <b id="latchCount">0</b></span>
      </div>

      <div class="hud__bottom">
        <span class="badge" id="badgeMode">LIVE</span>
        <span class="badge badge--muted" id="badgeOffline">offline: —</span>
        <span class="badge badge--muted" id="badgeFocus">focus: —</span>
      </div>
    </aside>

    <!-- HELP MODAL -->
    <div class="modal" id="helpModal" hidden aria-hidden="true" role="dialog" aria-modal="true">
      <div class="modal__backdrop" data-close="1"></div>
      <div class="modal__card" role="document">
        <div class="modal__head">
          <div class="modal__title">Как пользоваться</div>
          <button class="iconBtn" id="helpClose" type="button" aria-label="Close">✕</button>
        </div>

        <div class="modal__body">
          <ul class="helpList">
            <li><b>Live</b> — подсвечивает только пока клавиша зажата.</li>
            <li><b>Latch</b> — запоминает нажатые клавиши и держит подсветку, пока не нажмёшь <b>Clear</b>.</li>
            <li><b>Capture</b> — глушит часть хоткеев/скролл (Ctrl/⌘ + комбинации, Space, стрелки и т.п.).</li>
            <li>Подсветка завязана на <b>event.code</b> — это “физическая” клавиша.</li>
            <li>Если “не ловит” — кликни в пустое место страницы, чтобы дать фокус.</li>
          </ul>
        </div>

        <div class="modal__actions">
          <button class="btnPrimary" id="helpOk" type="button">OK</button>
        </div>
      </div>
    </div>
  </main>
</body>
</html>
